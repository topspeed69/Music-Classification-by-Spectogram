# Data Configuration for Audio Processing and Augmentation

data:
  # Data source configuration
  # For audio augmentation pipeline (new)
  audio_dir: 'AudioToSpectogram/fma_small_dataset'  # Directory with audio files
  train_val_split: 0.8                               # 80% train, 20% validation
  
  # For spectrogram-only pipeline (legacy)
  train_dir: 'data/train'                            # Directory with pre-computed spectrograms
  val_dir: 'data/val'                                # Directory with validation spectrograms
  
  # Audio settings for waveform processing
  audio:
    sample_rate: 22050      # Sample rate for audio
    duration: 3.0           # Audio duration in seconds (reduced from 30 for faster processing)
    n_fft: 2048            # FFT window size
    hop_length: 512        # Hop length for STFT
    n_mels: 128            # Number of mel frequency bins
    fmin: 0                # Minimum frequency
    fmax: 8000             # Maximum frequency (Nyquist: sr/2 = 11025)
  
  # Spectrogram settings
  spectrogram:
    type: "mel"            # Options: 'mel', 'linear', 'cqt'
    power: 2.0             # Power spectrogram
    log_scale: true        # Apply log scaling
    ref: 1.0               # Reference value for dB calculation
    amin: 1e-10            # Minimum amplitude threshold
    top_db: 80             # Top dB value for normalization
  
  # Dataset split ratios (for manual splitting)
  split:
    train: 0.8
    validation: 0.2        # Changed from 0.1 to 0.2 (using 80/20 split)
    test: 0.0              # No test set in current setup
    shuffle: true
    stratify: false        # Stratify by labels if available
  
  # Data loading
  dataloader:
    batch_size: 64         # Batch size (adjust based on GPU memory)
    num_workers: 10         # Number of worker threads
    pin_memory: true
    shuffle_train: true
    shuffle_val: false
    drop_last: true        # Drop incomplete batches
    prefetch_factor: 2     # Prefetch batches per worker
    persistent_workers: true  # Keep workers alive between epochs

# Augmentation Configuration
augmentation:
  # Number of augmentations to apply per sample
  num_augmentations: 3      # Apply 3 random augmentations
  apply_probability: 0.8    # Probability to apply augmentation pipeline
  
  # Individual augmentation settings
  transforms:
    # 1. Random Crop - DISABLED for consistent CNN input sizes
    random_crop:
      enabled: false
      probability: 0.8
      crop_size: [96, 970]  # [height, width] - 75% of original
      scale: [0.7, 1.0]     # Random scale range
      ratio: [0.75, 1.33]   # Aspect ratio range
    
    # 2. Color Jitter (Intensity variations)
    color_jitter:
      enabled: false
      probability: 0.8
      brightness: 0.4       # Brightness adjustment range
      contrast: 0.4         # Contrast adjustment range
      saturation: 0.4       # Saturation adjustment range
      hue: 0.1              # Hue adjustment range
    
    # 3. Gaussian Noise
    gaussian_noise:
      enabled: true
      probability: 0.8
      mean: 0.0
      std: 0.05             # Standard deviation of noise
      noise_type: "additive" # Options: 'additive', 'multiplicative'
    
    # 4. Horizontal Flip (Time reversal)
    horizontal_flip:
      enabled: false
      probability: 0.5      # 50% chance to flip
    
    # 5. Frequency Masking (SpecAugment)
    frequency_masking:
      enabled: true
      probability: 0.8
      max_mask_percentage: 0.15  # Max 15% of frequency bins
      num_masks: 2          # Number of frequency masks
    
    # 6. Time Masking (SpecAugment)
    time_masking:
      enabled: true
      probability: 0.8
      max_mask_percentage: 0.15  # Max 15% of time steps
      num_masks: 2          # Number of time masks
    
    # Additional augmentations (optional)
    random_rotation:
      enabled: false
      probability: 0.3
      degrees: [-5, 5]      # Rotation range in degrees
    
    gaussian_blur:
      enabled: false
      probability: 0.3
      kernel_size: 3
      sigma: [0.1, 2.0]

  # Normalization (applied after augmentation)
  normalization:
    mean: [0.485, 0.456, 0.406]  # ImageNet mean (for RGB)
    std: [0.229, 0.224, 0.225]   # ImageNet std
    
  # Resize settings
  resize:
    enabled: true
    height: 128
    width: 1293
    interpolation: "bilinear"  # Options: 'bilinear', 'bicubic', 'nearest'

# Data preprocessing
preprocessing:
  # Convert grayscale to RGB
  convert_to_rgb: true
  
  # Normalization method
  normalize_method: "standardize"  # Options: 'standardize', 'min_max', 'none'
  
  # Data type
  dtype: "float32"
  
  # Cache spectrograms in memory (for small datasets)
  cache_in_memory: false

# Note: For audio-based augmentation, use audio_augmentation_config.yaml instead
# The augmentation settings above apply to pre-computed spectrogram images only
  cache_data: false

# Paths
paths:
  audio_dataset: "AudioToSpectogram/fma_small_dataset"
  spectrogram_dir: "AudioToSpectogram/output_mel"
  train_list: "data/train_files.txt"
  val_list: "data/val_files.txt"
  test_list: "data/test_files.txt"
